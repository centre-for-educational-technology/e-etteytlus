<!DOCTYPE html>
<html>
	<head>
		<title>E-etteütlus</title>
		<meta charset="UTF-8"> 	
		<link rel="stylesheet" href="general.css">
		<link rel="stylesheet" href="form.css">
		<link rel="stylesheet" href="conductor.css">
		<script src="util.js" charset="utf-8"></script>
		<script src="fill.js" charset="utf-8"></script>
		<script src="nav.js" charset="utf-8"></script>
		<script src="form.js" charset="utf-8"></script>
		<script src="conductor.js" charset="utf-8"></script>
	</head>
	<body>	
	
	
		<!-- Text list -->
		<div id="textList" class="container" data-nav-state="hidden">
			<div class="w800">
				<h1>Kontrolltekstid</h1>	
				<table data-fill-table="texts" data-fill-on-rowclick="view_text">
					<tr data-fill-table-columns-silent="id">
						<th data-fill-table-columns="title">Pealkiri</th>
						<th data-fill-table-columns="authorName">Autor</th>
					</tr>
				</table>
				<button type="button" data-nav="#newText">Lisa Uus</button>
			</div>
		</div>
		
		<!-- Text detail -->
		<div id="textDetail" class="container" data-fill-table="texts" data-nav-state="hidden">
			<div class="w800">
				<h1 data-fill-columns="title"></h1>
				<h3 data-fill-columns="authorName"></h3>
				<h2 data-fill-columns="text"></h2>
				
				<form onsubmit="delete_text(event);">
					<input type="hidden" name="id" data-fill-columns="id" data-fill-targets="value">
					<button type="submit">Kustuta</button>
				</form>			
			</div>
		</div>
		
		<!-- Test list -->
		<div id="testList" class="container" data-nav-state="hidden">
			<div class="w800">
				<h1>Etteütlused</h1>
					<table data-fill-table="tests" data-fill-on-rowclick="view_test">
					<tr data-fill-table-columns-silent="id">
						<th data-fill-table-columns="code">Kood</th>
						<th data-fill-table-columns="submissions">Esitatud töid</th>
						<th data-fill-table-columns="conductorName">Juhendaja</th>
						<th data-fill-table-columns="textName">Kontrolltekst</th>
						<th data-fill-table-columns="dateEnd" data-fill-interpreter="interpret_test_status">Staatus</th>
					</tr>
				</table>
				<button type="button" data-nav="#newTest">Lisa Uus</button>
			</div>
		</div>
		
		<!-- New text -->
		<div id="newText" class="container" data-nav-state="hidden">
			<div class="w800">
				<h1>Lisa uus kontrolltekst</h1>
				<form onsubmit="submit_text(event);">
					<label for="ntxTitle">Pealkiri (ei kuvata vastajatele)</label>
					<input  type="text" id="ntxTitle" name="title" data-pattern=".{3,}" autocomplete="off" required>
					<label for="ntxText">Kontrolltekst</label>
					<textarea name="text" id="ntxText" data-pattern=".{3,}" rows="20" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" required></textarea>	
					<button type="submit">Salvesta</button>
					<button type="reset">Tühista</button>
				</form>
			</div>
		</div>
	
		<!-- New test -->
		<div id="newTest" class="container" data-nav-state="hidden">
			<div class="w400">
				<h1>Alusta uut etteütlust</h1>
				<form onsubmit="start_test(event);">
					<label for="ntsTextName">Etteütluse tekst</label>
					<select id="ntsTextName" name="textId" data-fill-table="texts" data-fill-columns="title, id" data-fill-interpreter="interpret_text_select" autocomplete="off" required></select>
					<label for="ntsDuration">Lubatud aeg minutites</label>
					<input type="text" data-pattern="^(0|[1-9][0-9]*)$" name="duration" value="30" required>
					<button type="submit">Genereeri kood</button>
				</form>
			</div>		
		</div>
		
		<!-- Start test -->
		<div id="startTest" class="container" data-fill-table="tests" data-nav-state="hidden" >
			<div class="w800">
				<h1>E-etteütlus "<span data-fill-columns="textName"></span>"</h1>
				
				<ul>
					<li>Etteütluse kood on ekraani peal kuvatav neljakohaline number.</li>
					<li>Etteütluse sooritamiseks peab osavõtja sisestama koodi.</li>
					<li>Kood kehtib alates "Alusta"-nupul klikkamisest teie poolt määratud ajaperioodi (<span data-fill-columns="dateEnd"></span> Min) lõpuni.</li>
					<li>Kirjutage kood suurelt tahvlile, edastage see osajalatele meilitsi või muul moel etteütluse alustamiseks.</li>		
				</ul>
				
				<h4 data-fill-columns="code"></h1>
				
				<form onreset="cancel_test(event);" onsubmit="conduct_test(event);">
					<input type="hidden" name="dateEnd" data-fill-columns="dateEnd" data-fill-targets="value">
					<input type="hidden" name="id" data-fill-columns="id" data-fill-targets="value">		
					<button type="submit">Alusta</button>
					<button type="reset">Tühista</button>
				</form>
				
			</div>
		</div>
		
		<!-- Conduct test -->
		<div id="conductTest" class="container" data-fill-table="tests" data-nav-state="hidden">
			<div class="w800">
				<h1>E-etteütlus "<span data-fill-columns="textName"></span>"</h1>
				<h2>Kood:</h2>
				<h4 data-fill-columns="code"></h4>
				<h2>Aega jäänud:</h2>
				<h4 data-fill-columns="dateEnd" data-fill-targets="data-countdown-end" data-countdown-end="0"></h4>
				
				
				<form onsubmit="stop_test(event);">
					<input type="hidden" name="id" data-fill-columns="id" data-fill-targets="value">
					<button type="submit">Lõpeta</button>
				</form>
				<button type="button" data-fill-columns="id" data-fill-targets="onclick" data-fill-interpreter="interpret_conduct_view_details">Esitatud tööd</button>
			</div>
		</div>
		
		<!-- Test detail -->
		<div id="testDetail" class="container" data-fill-table="tests" data-fill-columns-silent="id" data-nav-state="hidden">
			<div class="w800" >
				<h1>E-etteütlus <span data-fill-columns="code"></span> "<span data-fill-columns="textName"></span>"</h1>
				<table data-fill-table="submissions" data-fill-where="testId = $id" data-fill-on-rowclick="view_submission">
					<tr data-fill-table-columns-silent="id">
						<th data-fill-table-columns="surname">Perenimi</th>
						<th data-fill-table-columns="firstname">Eesnimi</th>
						<th data-fill-table-columns="email">E-post</th>
						<th data-fill-table-columns="totalLetters, totalWords, totalSentences, faultyLetters, faultyWords, faultySentences" data-fill-interpreter="interpret_submission_result">Tulemus</th>
					</tr>
				</table>
				<form onsubmit="delete_test(event);">
					<input type="hidden" name="id" data-fill-columns="id" data-fill-targets="value">
					<button type="submit">Kustuta</button>
				</form>	
			</div>
		</div>
		
		<!-- Submission detail -->
		<div id="submissionDetail" class="container" data-fill-table="submissions" data-fill-columns-silent="id" data-nav-state="hidden">
			<div class="w800">
				<h1>Sooritus etteütlusele <span data-fill-columns="testCode"></span></h1>
				<table><tr>
					<td>
						<h2>Nimi: <span data-fill-columns="firstname"></span> <span data-fill-column="surname"></span></h2>
						<h2>E-post: <span data-fill-columns="email"></span></h2>
						<h2>Kuupäev: <span data-fill-columns="date"></span></h2>
						<h2>Kontrolltekst: <span data-fill-columns="textTitle"></span></h2>
					</td><td>
						<h2>Vigaseid tähemärke: <span data-fill-columns="faultyLetters"></span></h2>
						<h2>Vigaseid sõnu: <span data-fill-columns="faultyWords"></span></h2>
						<h2>Vigaseid lauseid: <span data-fill-columns="faultySentences"></span></h2>
					</td>
				</tr></table>
				
				<h2 data-fill-columns="report"></h2>
			</div>
		</div>
		
		<!-- Message -->
		<div id="message" class="container" data-nav-state="hidden">
			<div class="msg">
				<h1></h1>
				<h2></h2>
			</div>
		</div>
		
		<!-- Nav -->
		<div id="nav" data-hidden>		
			<label data-nav="#textList">Kontrolltekstid</label>
			<label data-nav="#testList">Etteütlused</label>	
			<label data-nav="#newText">Uus Kontrolltekst</label>
			<label data-nav="#newTest">Uus Etteütlus</label>
			<label onclick="log_out()">Logi välja</label>
		</div>
		
		<div id="login" class="container">
			<div class="w400">
				<h1>E-etteütlus</h1>			
				<h3>Logi sisse!</h3>
				<form onsubmit="log_in(event);">
					<label for="firstname">Kasutajanimi või E-post</label>
					<input  type="text" id="username" name="username" data-pattern=".{3,}" autocomplete="off" required autofocus>
					<label for="surname">Parool</label>
					<input  type="password" id="password" name="password" data-pattern=".{3,}" autocomplete="off" required>
					<button type="submit">Logi sisse</button>
				</form>	
			</div>
		</div>

		<script type="text/javascript">onLoad(function() {start_page();});</script>
	</body>
</html>